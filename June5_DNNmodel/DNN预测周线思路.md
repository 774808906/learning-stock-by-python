# 使用神经网络预测周线
虽然这个思路一看就不靠谱，但可以作为一个运用的小例子。

## 数据准备
* 通过Tushare库获取上证所有股票2018年一月到2019年一月间51周行情信息
* 听取fyy的建议，只选用周K线图和成交量作为输入信息，具体就是输入维度就是51 * 5， 
5就是open, close, high, low, vol。
因此，共有1180多只股票满足训练要求（部分股票有停牌等情况，直接剔除防止意外），可以作为训练样本。

**我的目标是告诉网络前50周的K线变化图，让其预测第51周的K线。**

那么，整个输入数据就可以表示为1180 * 250， 相当于每个样本是 1* 250 的向量。 250就是50周 * 5。
同时，训练的标签就是简单的 1 * 4， 即51周的K线。 成交量没有太大实际意义，因此为降低网络难度，不做预测。

这个数据可以通过June5.py运行后获得并保存为npy文件，以免每次都要运行通过Tushare去在线获取。

## 网络模型

我也不知道如何入手，于是使用最万能的DNN网络，结合BN层及Adam优化器进行训练，具体网络结构运行代码后会直接由model.summary打印出来，一目了然。


## 验证结果
 - <img src="https://github.com/TianLin0509/learning-stock-by-python/blob/master/June5_DNNmodel/example.png" width = "350" height = "300" alt="神经网络预测周线" align=center /> 

可以看到，性能惨不忍睹，横坐标代表不同的股票 （我将80只股票提前剥离出来不参与训练和验证，作为测试集）。

## 问题所在
虽然神经网络是玄学，但这个结果其实预想之中。我觉得改进方向有以下几个：
* 样本数量太少
* 信息量太少，可以考虑增大时间，如将股票历史周线图全部作为输入，然后也增大网络规模。
* 强化学习中的DQN更适合应对这类问题，DNN有点难。
* 只提供K线图和成交量，和没提供什么信息其实差别不大。
* 用回归模型来预测的核心是相似曲线背后相似的人性。 很明显，在这个程序中完全没有体现出来。 需要有一个更好的建模思路。
